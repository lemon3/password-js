var P=Object.defineProperty;var S=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var v=(a,t,e)=>t in a?P(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,l=(a,t)=>{for(var e in t||(t={}))x.call(t,e)&&v(a,e,t[e]);if(S)for(var e of S(t))E.call(t,e)&&v(a,e,t[e]);return a};var m=(a,t,e)=>v(a,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();const w={lowercase:"abcdefghijklmnopqrstuvwxyz",uppercase:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",numbers:"0123456789",symbols:`!"#$%&'()*+,-./:;<=>?@[]^_{|}~`,umlauts:"äöüÄÖÜ"},L={length:10,lowercase:!0,uppercase:!0,numbers:!0,symbols:!0,umlauts:!1,excludeSimilar:!1,normalDistribute:!1},b={lowercase:0,uppercase:0,numbers:0,symbols:0,umlauts:0},j=a=>{const t=[...a];for(let e=t.length-1;e>0;e--){const o=Math.floor(Math.random()*(e+1));[t[e],t[o]]=[t[o],t[e]]}return t},O=a=>a===!0?1:Number(a),A="lOI01|";class q{constructor(){m(this,"charGroups");m(this,"settings");m(this,"charsUpdated");m(this,"charset");m(this,"filteredCharGroups");m(this,"lastExcludeSimilar",!1);this.charGroups=l({},w),this.filteredCharGroups=l({},w),this.charsUpdated=!1,this.charset=""}getCharGroups(){const t=!!this.settings.excludeSimilar;if(!t)return this.lastExcludeSimilar=!1,this.charGroups;if(this.charsUpdated||this.lastExcludeSimilar!==t){const e=l({},this.charGroups);for(const[o,s]of Object.entries(e))e[o]=[...s].filter(r=>!A.includes(r)).join("");this.filteredCharGroups=e,this.charsUpdated=!1,this.lastExcludeSimilar=t}return this.filteredCharGroups}computePasswordArray(t,e=!1){var d;const o=[],s=l({},b);let r=0,i=0;const f=[];this.charset="";const g=n=>{const c=n.name,p=n.chars;f.push(p[Math.floor(Math.random()*p.length)]),s[c]++};for(const[n,c]of Object.entries(t)){const p=this.settings[n];if(!p||!c)continue;const y=O(p),G=O(this.settings[`${n}Weight`])||0;o.push({name:n,chars:c,weight:G}),s[n]=y;for(let M=0;M<y;M++)f.push(c[Math.floor(Math.random()*c.length)]);this.charset+=c,r+=y,i+=G}const u=Math.max((d=this.settings.length)!=null?d:0,r)-r;if(!e){for(let n=0;n<u;n++){const c=this.charset[Math.floor(Math.random()*this.charset.length)];f.push(c);const p=this.getGroupFromChar(c);p&&s[p.name]++}return{password:f,statistic:s}}if(u>0)if(i>0){let n=0;for(const c of o){const p=Math.floor(c.weight/i*u);if(p!==0){n+=p;for(let y=0;y<p;y++)g(c)}}for(let c=0;n<u;c++,n++)g(o[c%o.length])}else for(let n=0;n<u;n++)g(o[n%o.length]);return{password:f,statistic:s}}generatePassword(t,e){if(!t)return{password:"",length:0,strength:0,entropy:0,statistic:l({},b)};const s=j(t).join(""),r=s.length,i=r*Math.log2(this.charset.length),f=Math.min(i/100,1);return e||(e=l({},b)),{entropy:i,length:r,password:s,strength:f,statistic:e}}getGroupFromChar(t){for(const[e,o]of Object.entries(w))if(o.includes(t))return{name:e,chars:o}}updateChars(t){this.charGroups=l(l({},this.charGroups),t),this.filteredCharGroups=l({},this.charGroups),this.charsUpdated=!0}getCharset(){return this.charset}test(t){const e=l({},b);if(!t)return{entropy:0,length:0,statistic:e,strength:0};let o="";for(const f of t){const g=this.getGroupFromChar(f);if(g){const{name:h,chars:u}=g;e[h]===0&&(o+=u),e[h]++}}const s=t.length,r=s*Math.log2(o.length),i=Math.min(r/100,1);return{entropy:r,length:s,statistic:e,strength:i}}create(t){if(this.settings=l(l({},L),t),this.settings.length||(this.settings.length=L.length),!Object.entries(w).some(([i])=>this.settings[i]))return this.generatePassword();const o=this.getCharGroups(),{password:s,statistic:r}=this.computePasswordArray(o,this.settings.normalDistribute);return this.generatePassword(s,r)}}const D=()=>new q;document.querySelector("#app").innerHTML=`
  <div>
    <h1>Random Password</h1>
    <div class="button-group">
      <button class="user-select-none" id="generate" type="button">generate new</button>
    </div>

    <div class="password-wrapper">
      <input id="test-password" type="text" />
      <div class="strength-bar-wrapper">
        <div class="strength-bar" id="strength-bar"></div>
      </div>
    </div>
    <div id="strength-result"></div>
  </div>
`;const C=()=>{const a=document.querySelector("#generate"),t=document.querySelector("#test-password"),e=document.querySelector("#strength-result"),o=document.querySelector("#strength-bar"),s=D();let r;const i=h=>{if(e){const u=100*h.strength,d=+u.toFixed(0);e.textContent=h.entropy===0?"":`${d}%`,o.style.width=""+u+"%",console.log(h.statistic);let n="p0";d<20?n="p0":d<40?n="p20":d<60?n="p40":d<80?n="p60":d<=100&&(n="p80"),o.classList.remove(r),o.classList.add(n),r=n}},f=()=>{if(!t)return;const h=s.test(t.value);i(h)},g=h=>{h&&h.preventDefault();const u={length:12,normalDistribute:!1},d=s.create(u);t.value=`${d.password}`,i(d)};g(),a&&t&&(a.addEventListener("click",g),t.addEventListener("input",f))};document.readyState==="complete"||document.readyState==="interactive"?(C(),document.removeEventListener("DOMContentLoaded",C)):document.addEventListener("DOMContentLoaded",C,!1);
